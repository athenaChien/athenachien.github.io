<div class="card text-themed project">
  {% if project_img %}
    <img
      id="{{ project_id }}-img"
      class="card-img-top"
      src="{{ project_img | relative_url }}"
      alt="{{ project_name }}">
  {% endif %}

  <div class="card-body">
    {%- comment -%}
      Build href:
      - Remote: use project.link if set, else project_url (GitHub repo)
      - Local: only use project.link (no implicit internal link)
    {%- endcomment -%}
    {%- assign href = nil -%}
    {%- if project_type == "remote" -%}
      {%- assign href = project.link | default: project_url -%}
    {%- elsif project.link -%}
      {%- assign href = project.link -%}
    {%- endif -%}

    <!-- Title: linked only when href exists -->
    <h5 id="{{ project_id }}-name" class="card-title">
      {% if project_type == "remote" %}
        <i class="fab fa-github" aria-hidden="true"></i>&nbsp;
      {% endif %}
      {% if href %}
        <a href="{{ href }}"{% if external or site.open_new_tab %} target="_blank" rel="noopener"{% endif %}>
          {{ project_name }}
        </a>
      {% else %}
        {{ project_name }}
      {% endif %}
    </h5>

    <!-- Meta: role • PI • year (no leading dot) + team -->
    {% if project_role or project_pi or project_year or project_team %}
      <p class="text-muted small mb-2">
        {% if project_role %}{{ project_role }}{% endif %}
        {% if project_pi %}{% if project_role %} · {% endif %}{{ project_pi }}{% endif %}
        {% if project_year %}{% if project_role or project_pi %} · {% endif %}{{ project_year }}{% endif %}
        {% if project_team %}<br><span class="project-team">{{ project_team }}</span>{% endif %}
      </p>
    {% endif %}

    {% if project_desc %}
      <p id="{{ project_id }}-desc" class="card-text">{{ project_desc }}</p>
    {% endif %}

    {% if project_tools and project_tools.size > 0 %}
      <p id="{{ project_id }}-tools" class="card-text">
        {% for tool in project_tools %}
          <span class="badge badge-pill text-primary border border-primary ml-1">{{ tool }}</span>
        {% endfor %}
      </p>
    {% endif %}

    {% if project_research_skills or project_technical_skills %}
      <div class="mt-1">
        {% if project_research_skills %}
          {% for s in project_research_skills limit:2 %}
            <span class="badge badge-pill border ml-1">{{ s }}</span>
          {% endfor %}
        {% endif %}
        {% if project_technical_skills %}
          {% for s in project_technical_skills limit:2 %}
            <span class="badge badge-pill border ml-1">{{ s }}</span>
          {% endfor %}
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
